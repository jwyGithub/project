"use strict";var _createClass=function(){function e(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}();function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}define(function(){function t(){_classCallCheck(this,t),this.span=document.getElementById("magnifier"),this.big=document.querySelector(".big"),this.small=document.querySelector(".small"),this.smallImg=document.querySelector(".small img"),this.bigImg=document.querySelector(".big img"),this.liImg=document.querySelectorAll(".items li a img"),this.addEvent()}function i(){_classCallCheck(this,i),this.id=m("goodsId"),this.load()}function m(t){for(var i=document.cookie.split("; "),s=0;s<i.length;s++)if(i[s].split("=")[0]==t)return i[s].split("=")[1];return""}return{banner:(_createClass(t,[{key:"addEvent",value:function(){var s=this;this.small.onmouseover=function(t){s.over()},this.small.onmousemove=function(t){var i=t||window.event;s.move(i)},this.small.onmouseout=function(){s.out()},this.setImg()}},{key:"over",value:function(){this.span.style.display="block",this.big.style.display="block",this.sSpanW=this.big.offsetWidth/this.bigImg.offsetWidth*this.small.offsetWidth,this.sSpanH=this.big.offsetHeight/this.bigImg.offsetHeight*this.small.offsetHeight,this.span.style.width=this.sSpanW+"px",this.span.style.height=this.sSpanH+"px",this.bigW=this.big.offsetWidth,this.bigH=this.big.offsetHeight,this.smallW=this.small.offsetWidth,this.smallH=this.small.offsetHeight,this.bigImgW=this.bigImg.offsetWidth,this.bigImgH=this.bigImg.offsetHeight}},{key:"move",value:function(t){var i=t.clientY-this.span.offsetHeight-this.span.offsetHeight-this.span.offsetHeight/2,s=t.clientX-this.span.offsetWidth-this.span.offsetWidth/2;s<0&&(s=0),i<0&&(i=0),s>this.small.offsetWidth-this.span.offsetWidth&&(s=this.small.offsetWidth-this.sSpanW),i>this.small.offsetHeight-this.sSpanH&&(i=this.small.offsetHeight-this.sSpanH),this.span.style.left=s+"px",this.span.style.top=i+"px",this.bigImg.style.left=s/(this.smallW-this.sSpanW)*(this.bigW-this.bigImgW)+"px",this.bigImg.style.top=i/(this.smallH-this.sSpanH)*(this.bigH-this.bigImgH)+"px"}},{key:"out",value:function(){this.span.style.display="none",this.big.style.display="none"}},{key:"setImg",value:function(){for(var i=this,s=this,t=function(t){i.liImg[t].onclick=function(){s.bigImg.src="",s.smallImg.src="",s.bigImg.src=s.liImg[t].src,s.smallImg.src=s.liImg[t].src}},e=0;e<this.liImg.length;e++)t(e)}}]),t),detail:(_createClass(i,[{key:"load",value:function(){var i=this;$.ajax({url:"http://localhost:81/common/details",data:{goodsId:i.id},success:function(t){i.res=JSON.parse(t),i.display()}})}},{key:"display",value:function(){for(var t="",i=0;i<this.res.imgs.length;i++)t+='<li><a href="#"><img src="'+this.res.imgs[i]+'" alt=""></a></li>';$(".box").html('<div class="small">\n                                <img src="'+this.res.imgs[0]+'">\n                                <span id="magnifier"></span>\n                            </div>\n                            <div class="big">\n                                <img src="'+this.res.imgs[0]+'" alt="">\n                            </div>\n                            <ul class="items clearfix">\n                                '+t+"\n                            </ul>"),$(".price").html(this.res.price+"å…ƒ"),$(".overmore").html(this.res.info),$(".right").find("h3").html(this.res.title).attr("id",this.res.id),this.addEvent()}},{key:"addEvent",value:function(){var r=this,c=this;$(".date").find("dd").click(function(){$(this).addClass("checked").siblings().removeClass("checked")}),$(".year").find("dd").click(function(){$(this).addClass("checked").siblings().removeClass("checked")}),$("#addCar").click(function(t){if((t||window.event).preventDefault(),m("user")){for(var i=document.querySelectorAll(".date dd"),s=0;s<i.length;s++)if("checked"==i[s].className)var e=i[s].innerHTML;for(var l=document.querySelectorAll(".year dd"),n=0;n<l.length;n++)if("checked"==l[n].className)var a=l[n].innerHTML;if(r.goodItems=m("details")?JSON.parse(m("details")):[],r.goodItems.length<1){var o=$(".right").find("h3").attr("id");r.goodItems.push({id:o,img:$(".small").find("img").attr("src"),title:$(".right").find("h3").html(),pubDate:e,pubYear:a,price:$(".price").text(),number:$("#num").val()})}else{for(var h=0;h<r.goodItems.length;h++)r.goodItems[h].id===o&&r.goodItems[h].number++;h=0,r.goodItems.some(function(t,i){return h=i,t.id===r.id})?r.goodItems[h].number++:(o=$(".right").find("h3").attr("id"),r.goodItems.push({id:o,img:$(".small").find("img").attr("src"),title:$(".right").find("h3").html(),pubDate:e,pubYear:a,price:$(".price").text(),number:$("#num").val()}))}!function(t,i,s){var e=(s=s||{}).path?";path="+s.path:"",l="";if(s.expires){var n=new Date;n.setDate(n.getDate()+s.expires),l=";expires="+n}document.cookie=t+"="+i+l+e}("details",JSON.stringify(r.goodItems),{path:"/"}),location.href="http://localhost/car/car.html"}else $(".war").css("display","block"),c.back()})}},{key:"back",value:function(){$("#login").click(function(){location.href="http://localhost/login/login.html"}),$("#reg").click(function(){$(".war").css("display","none")})}}]),i)}});